#!/bin/bash

######################################
#   In crontab -e                    #
#   * * * * * /home/olaf/task_4.sh   #
######################################

t=4
while [ $t -gt 2 ];
do
echo “Select on or many of options:”
echo “1 .Number of CPU Cores”
echo “2 .Disk space”
echo “3 .Size of RAM”
echo “4 .Information about the last users logged on the host”
echo “5 .Calculate the number of active python/perl process”
echo “6 .Send all the info on email”
echo “CTRL+C to leave the program”
echo “Enter your option as eg. 134 to display options 1,3 and 4: ”

var1=$(nproc)
var2=$(df | awk '{ sum+=$2 } END {printf("Total diskspace: %skB\n", sum)}')
var3=$(grep MemTotal /proc/meminfo | awk '{printf("%skB\n", $2)}')
var4=$(last | grep -v 'reboot' > mm.txt && sed -i '$ d' mm.txt && cat mm.txt | awk '{print $1}')     
var5=$(ps aux | grep -e perl -e python | grep -v grep | wc -l)

read l
for (( i=0; i<${#l}; i++ ));
do
letter="${l:$i:1}"
if [ $letter == "1" ]
then
echo "Number of cores: $var1"
elif [ $letter == "2" ]
then
echo "Total memory: $var2 kB"
elif [ $letter == "3" ]
then
echo "RAM memory: $var3 kB"
elif [ $letter == "4" ]
then
echo "Last users: $var4"
elif [ $letter == "5" ]
then
echo "Active perl/python processes: $var5"
elif [ $letter == "6" ]
then
echo -e "Number of cores: $var1\nTotal memory: $var2 kB\nRAM memory: $var3 kB\nLast users: $var4\nActive perl/python processes: $var5" | ssmtp -vvv olaf.serafin305@gmail.com
fi
done
done
